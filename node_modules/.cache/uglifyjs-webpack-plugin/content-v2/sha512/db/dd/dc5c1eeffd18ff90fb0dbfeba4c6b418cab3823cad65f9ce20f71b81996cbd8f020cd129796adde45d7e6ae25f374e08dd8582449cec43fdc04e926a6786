{"map":"{\"version\":3,\"sources\":[\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"],\"names\":[\"IconShape\",\"React\",\"__importStar\",\"__webpack_require__\",\"cesium_1\",\"cesium_react_1\",\"exports\",\"Pin\",\"_super\",\"_this\",\"apply\",\"this\",\"arguments\",\"state\",\"iconImage\",\"image\",\"canvas\",\"document\",\"createElement\",\"__extends\",\"prototype\",\"componentDidMount\",\"props\",\"renderIcon\",\"componentWillReceiveProps\",\"nextProps\",\"iconColor\",\"iconShape\",\"iconSize\",\"render\",\"_a\",\"id\",\"name\",\"lat\",\"lon\",\"isNaN\",\"console\",\"log\",\"Entity\",\"position\",\"Cartesian3\",\"fromDegrees\",\"billboard\",\"scaleByDistance\",\"NearFarScalar\",\"polyline\",\"positions\",\"material\",\"Color\",\"WHITE\",\"show\",\"loadImage\",\"size\",\"getImage\",\"_b\",\"sent\",\"error\",\"e_1\",\"width\",\"height\",\"ctx\",\"getContext\",\"clearRect\",\"globalCompositeOperation\",\"drawImage\",\"setState\",\"getImageData\",\"thisimage\",\"Promise\",\"resolve\",\"reject\",\"img\",\"Image\",\"onload\",\"onerror\",\"e\",\"src\",\"undefined\",\"PureComponent\"],\"mappings\":\"wgEAAA,IAIYA,EAJZC,EAAAC,EAAAC,EAAA,IACAC,EAAAD,EAAA,GACAE,EAAAF,EAAA,KAEA,SAAYH,GACVA,EAAAA,EAAA,MAAA,GAAA,QADF,CAAYA,EAAAM,EAAAN,YAAAM,EAAAN,eAyBZ,IAEAO,EAAA,SAAAC,GAAA,SAAAD,IAAA,IAAAE,EAAA,OAAAD,GAAAA,EAAAE,MAAAC,KAAAC,YAAAD,YACEF,EAAAI,OACEC,UAAW,MAGLL,EAAAM,MAAiC,KACjCN,EAAAO,OAASC,SAASC,cAAc,YAsF1C,OA5FiCC,EAAAZ,EAAAC,GAQ/BD,EAAAa,UAAAC,kBAAA,WACMV,KAAKW,MAAMR,WACbH,KAAKY,YAAW,IAIpBhB,EAAAa,UAAAI,0BAAA,SAA0BC,GAEtBA,EAAUX,WAAcW,EAAUX,WAClCW,EAAUC,WAAcD,EAAUC,WAClCD,EAAUE,WAAcF,EAAUE,WAClCF,EAAUG,UAAaH,EAAUG,UAEjCjB,KAAKY,WAAWE,EAAUX,WAAcW,EAAUX,YAItDP,EAAAa,UAAAS,OAAA,WACQ,IAAAC,EAAAnB,KAAAW,MAAES,EAAAD,EAAAC,GAAIC,EAAAF,EAAAE,KAAMC,EAAAH,EAAAG,IAAKC,EAAAJ,EAAAI,IACfpB,EAAAH,KAAAE,MAAAC,UACR,OAAKA,GAAaqB,MAAMF,IAAQE,MAAMD,IACpCE,QAAQC,IAAIL,EAAK,IAAIC,EAAI,IAAIC,GACtB,MAGPjC,EAAAiB,cAACb,EAAAiC,QACCP,GAAIA,EACJC,KAAMA,EACNO,SAAUnC,EAAAoC,WAAWC,YAAYP,EAAKD,EAtC/B,KAuCPS,WACE3B,MAAOD,EACP6B,gBAAiB,IAAIvC,EAAAwC,cAAc,IAAM,EAAG,IAAO,KAErDC,UACEC,WACE1C,EAAAoC,WAAWC,YAAYP,EAAKD,EAAK,GACjC7B,EAAAoC,WAAWC,YAAYP,EAAKD,EA9CzB,MAgDLc,SAAU3C,EAAA4C,MAAMC,MAChBC,MAAM,MAMA3C,EAAAa,UAAAG,WAAd,SAAyB4B,uGACjBC,EAAOzC,KAAKW,MAAMM,UAAY,kDAG9BjB,KAAKI,QAASoC,GAAf,EAAA,IACDrB,EAAAnB,MAAa,EAAMA,KAAK0C,SAAS1C,KAAKW,MAAMR,oBAA5CgB,EAAKf,MAAQuC,EAAAC,2CAIf,kBADAnB,QAAQoB,MAAMC,IACd,iBAGF9C,KAAKK,OAAO0C,MAAQN,EACpBzC,KAAKK,OAAO2C,OAASP,GACfQ,EAAMjD,KAAKK,OAAO6C,WAAW,OAC/BC,UAAU,EAAG,EAAGV,EAAMA,GAC1BQ,EAAIG,yBAA2B,cAC/BH,EAAII,UAAUrD,KAAKI,MAAO,EAAG,EAAGqC,EAAMA,GAEtCzC,KAAKsD,UACHnD,UAAW8C,EAAIM,aAAa,EAAG,EAAGd,EAAMA,eAIpC7C,EAAAa,UAAAiC,SAAR,SAAiBc,GACf,OAAKA,EAGE,IAAIC,QAAQ,SAACC,EAASC,GAC3B,IAAMC,EAAM,IAAIC,MAChBD,EAAIE,OAAS,WACXJ,EAAQE,IAEVA,EAAIG,QAAU,SAAAC,GACZL,EAAOK,IAETJ,EAAIK,IAAMT,IAVHC,QAAQE,YAAOO,IAa5BtE,EA5FA,CAAiCN,EAAM6E,ghBA/BvC7E,wGAIYD,4GAyBG,2GAEfO\",\"sourcesContent\":[\"import * as React from \\\"react\\\";\\nimport { Cartesian3, Color, NearFarScalar } from \\\"cesium\\\";\\nimport { Entity } from \\\"cesium-react\\\";\\n\\nexport enum IconShape {\\n  Round,\\n}\\n\\ninterface Props {\\n  id: string;\\n  // regionName_jp: string;\\n  name: string;\\n  // regionName_en: string;\\n  // regionName_h: string;\\n  // year: string;\\n  // person: string;\\n  // bible: string;\\n  lat: number;\\n  lon: number;\\n  iconColor: string;\\n  iconShape: IconShape;\\n  iconSize?: number;\\n  iconImage?: string;\\n}\\n\\ninterface State {\\n  iconImage: ImageData | null;\\n}\\n\\nconst height = 400;\\n\\nexport default class Pin extends React.PureComponent<Props, State> {\\n  state: State = {\\n    iconImage: null,\\n  };\\n\\n  private image: HTMLImageElement | null = null;\\n  private canvas = document.createElement(\\\"canvas\\\");\\n\\n  componentDidMount() {\\n    if (this.props.iconImage) {\\n      this.renderIcon(true);\\n    }\\n  }\\n\\n  componentWillReceiveProps(nextProps: Props) {\\n    if (\\n      nextProps.iconImage !== nextProps.iconImage ||\\n      nextProps.iconColor !== nextProps.iconColor ||\\n      nextProps.iconShape !== nextProps.iconShape ||\\n      nextProps.iconSize !== nextProps.iconSize\\n    ) {\\n      this.renderIcon(nextProps.iconImage !== nextProps.iconImage);\\n    }\\n  }\\n\\n  render() {\\n    const { id, name, lat, lon } = this.props;\\n    const { iconImage } = this.state;\\n    if (!iconImage || isNaN(lat) || isNaN(lon)) {\\n      console.log(name+\\\"+\\\"+lat+\\\"+\\\"+lon);\\n      return null;\\n    }\\n    return (\\n      <Entity\\n        id={id}\\n        name={name}\\n        position={Cartesian3.fromDegrees(lon, lat, height)}\\n        billboard={{\\n          image: iconImage,\\n          scaleByDistance: new NearFarScalar(5000, 1, 50000, 0.2),\\n        }}\\n        polyline={{\\n          positions: [\\n            Cartesian3.fromDegrees(lon, lat, 0),\\n            Cartesian3.fromDegrees(lon, lat, height),\\n          ],\\n          material: Color.WHITE,\\n          show: true,\\n        }}\\n      />\\n    );\\n  }\\n\\n  private async renderIcon(loadImage: boolean) {\\n    const size = this.props.iconSize || 120;\\n\\n    try {\\n      if(!this.image || loadImage){\\n        this.image = await this.getImage(this.props.iconImage);\\n      }\\n    } catch (e) {\\n      console.error(e);\\n      return;\\n    }\\n\\n    this.canvas.width = size;\\n    this.canvas.height = size;\\n    const ctx = this.canvas.getContext(\\\"2d\\\") as CanvasRenderingContext2D;\\n    ctx.clearRect(0, 0, size, size);\\n    ctx.globalCompositeOperation = \\\"source-over\\\";\\n    ctx.drawImage(this.image, 0, 0, size, size);\\n\\n    this.setState({\\n      iconImage: ctx.getImageData(0, 0, size, size),\\n    });\\n  }\\n\\n  private getImage(thisimage: string | undefined): Promise<HTMLImageElement> {\\n    if (!thisimage) {\\n      return Promise.reject(undefined);\\n    }\\n    return new Promise((resolve, reject) => {\\n      const img = new Image();\\n      img.onload = () => {\\n        resolve(img);\\n      };\\n      img.onerror = e => {\\n        reject(e);\\n      };\\n      img.src = thisimage as string;\\n    });\\n  }\\n}\\n\"]}","code":"webpackHotUpdate(0,{53:function(e,t,n){\"use strict\";(function(e){!function(){var t=n(2).enterModule;t&&t(e)}();var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,\"__esModule\",{value:!0});var s,c=a(n(3)),l=n(1),u=n(21);!function(e){e[e.Round=0]=\"Round\"}(s=t.IconShape||(t.IconShape={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={iconImage:null},t.image=null,t.canvas=document.createElement(\"canvas\"),t}return r(t,e),t.prototype.componentDidMount=function(){this.props.iconImage&&this.renderIcon(!0)},t.prototype.componentWillReceiveProps=function(e){e.iconImage==e.iconImage&&e.iconColor==e.iconColor&&e.iconShape==e.iconShape&&e.iconSize==e.iconSize||this.renderIcon(e.iconImage!=e.iconImage)},t.prototype.render=function(){var e=this.props,t=e.id,n=e.name,r=e.lat,i=e.lon,o=this.state.iconImage;return!o||isNaN(r)||isNaN(i)?(console.log(n+\"+\"+r+\"+\"+i),null):c.createElement(u.Entity,{id:t,name:n,position:l.Cartesian3.fromDegrees(i,r,400),billboard:{image:o,scaleByDistance:new l.NearFarScalar(5e3,1,5e4,.2)},polyline:{positions:[l.Cartesian3.fromDegrees(i,r,0),l.Cartesian3.fromDegrees(i,r,400)],material:l.Color.WHITE,show:!0}})},t.prototype.renderIcon=function(e){return i(this,void 0,void 0,function(){var t,n,r,i;return o(this,function(o){switch(o.label){case 0:t=this.props.iconSize||120,o.label=1;case 1:return o.trys.push([1,4,,5]),this.image&&!e?[3,3]:(n=this,[4,this.getImage(this.props.iconImage)]);case 2:n.image=o.sent(),o.label=3;case 3:return[3,5];case 4:return r=o.sent(),console.error(r),[2];case 5:return this.canvas.width=t,this.canvas.height=t,(i=this.canvas.getContext(\"2d\")).clearRect(0,0,t,t),i.globalCompositeOperation=\"source-over\",i.drawImage(this.image,0,0,t,t),this.setState({iconImage:i.getImageData(0,0,t,t)}),[2]}})})},t.prototype.getImage=function(e){return e?new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=function(e){n(e)},r.src=e}):Promise.reject(void 0)},t}(c.PureComponent);t.default=p,function(){var t=n(2).default,l=n(2).leaveModule;t&&(t.register(r,\"__extends\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),t.register(i,\"__awaiter\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),t.register(o,\"__generator\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),t.register(a,\"__importStar\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),t.register(c,\"React\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),t.register(s,\"IconShape\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),t.register(400,\"height\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),t.register(p,\"Pin\",\"/Users/haradamakiko/git/bible/cesium-react/example/src/components/Pin/index.tsx\"),l(e))}()}).call(this,n(4)(e))}});","extractedComments":[]}